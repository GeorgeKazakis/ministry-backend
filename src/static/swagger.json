{
  "openapi": "3.0.3",

  "info": {
    "title": "Υπουργείο Εσωτερικών",
    "version": "0.0.1",
    "description": "Τεκμηρίωση του API τoυ συστήματος παρακολούθησης αρμοδιοτήτων μεταξύ των φορέων της Δημόσιας Διοίκησης.",
    "contact": {
      "name": "Υπουργείο Εσωτερικών",
      "url": "https://www.ypes.gr",
      "email": "antpsarakis@gmail.com"
    },
    "license": {
      "name": "Άδεια Χρήσης",
      "url": "https://creativecommons.org/licenses/by/4.0/"
    }
  },

  "tags": [
    {
      "name": "ΠΣΠΕΔ - Φορείς",
      "description": "Δεδομένα Φορέων, όπως εμπλουτίζονται στο ΠΣΠΕΔ"
    },
    {
      "name": "Δεδομένα Απογραφής - Λεξικά",
      "description": "Λεξικά που συγχρονίζονται ημερήσια από το API της Απογραφής",
      "externalDocs": {
        "description": "Λεξικά Απογραφής",
        "url": "https://t.ly/-WBAk"
      }
    },
    {
      "name": "Δεδομένα Απογραφής - Φορείς",
      "description": "Φορείς που συγχρονίζονται ημερήσια από το API της Απογραφής",
      "externalDocs": {
        "description": "Φορείς Απογραφής",
        "url": "https://t.ly/gIFkc"
      }
    },
    {
      "name": "Δεδομένα Απογραφής - Μονάδες",
      "description": "Μονάδες που συγχρονίζονται ημερήσια από το API της Απογραφής",
      "externalDocs": {
        "description": "Μονάδες Απογραφής",
        "url": "https://t.ly/wX3Dc"
      }
    }
  ],

  "paths": {
    "/apografi/dictionary/{dictionary}/{id}/description": {
      "get": {
        "summary": "Επιστρέφει την περιγραφή του λεξικού από το id",
        "tags": ["Δεδομένα Απογραφής - Λεξικά"],
        "parameters": [
          {
            "name": "dictionary",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },

    "/apografi/dictionary/{dictionary}/{description}/id": {
      "get": {
        "summary": "Επιστρέφει το id του λεξικού από την περιγραφή",
        "tags": ["Δεδομένα Απογραφής - Λεξικά"],
        "parameters": [
          {
            "name": "dictionary",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "description",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },

    "/apografi/dictionary/{dictionary}": {
      "get": {
        "summary": "Επιστρέφει τη συνολική καταχώρηση του λεξικού",
        "tags": ["Δεδομένα Απογραφής - Λεξικά"],
        "parameters": [
          {
            "name": "dictionary",
            "in": "path",
            "required": true,
            "description": "Το όνομα του λεξικού από την απογραφή (https://t.ly/dWBz1)",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "apografi_id": { "type": "integer" },
                      "parentId": { "type": "integer" },
                      "code": { "type": "string" },
                      "code_el": { "type": "string" },
                      "description": { "type": "string" }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },

    "/apografi/dictionary/{dictionary}/ids": {
      "get": {
        "summary": "Επιστρέφει τα id του λεξικού",
        "tags": ["Δεδομένα Απογραφής - Λεξικά"],
        "parameters": [
          {
            "name": "dictionary",
            "in": "path",
            "required": true,
            "description": "Το όνομα του λεξικού από την απογραφή (https://t.ly/dWBz1)",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "type": "integer" }
                }
              }
            }
          }
        }
      }
    },

    "/apografi/organization/{code}": {
      "get": {
        "summary": "Επιστρέφει το φορέα με τον κωδικό code",
        "tags": ["Δεδομένα Απογραφής - Φορείς"],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός του φορέα",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Ο Φορέας βρέθηκε",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          }
        }
      }
    },

    "/apografi/organization/{label}/label": {
      "get": {
        "summary": "Επιστρέφει τους φορείς που η επίσημη ονομασία τους περιέχει το label",
        "tags": ["Δεδομένα Απογραφής - Φορείς"],
        "parameters": [
          {
            "name": "label",
            "in": "path",
            "required": true,
            "description": "Μέρος της επίσημης ονομασίας του φορέα",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          }
        }
      }
    },

    "/apografi/organization/{code}/units": {
      "get": {
        "summary": "Επιστρέφει τις μονάδες του φορέα με τον κωδικό code",
        "tags": ["Δεδομένα Απογραφής - Μονάδες"],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός του φορέα",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Οι μονάδες του φορέα βρέθηκαν",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "units": {
                      "type": "array",
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Δεν βρέθηκαν μονάδες ή ο κωδικός του φορέα δεν υπάρχει",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },

    "/apografi/organization/{code}/general-directorates": {
      "get": {
        "summary": "Επιστρέφει τις Γενικές Διευθύνσεις του φορέα με τον κωδικό code",
        "tags": ["Δεδομένα Απογραφής - Μονάδες"],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός του φορέα",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Οι Γενικές Διευθύνσεις του φορέα βρέθηκαν",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "units": {
                      "type": "array",
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Δεν βρέθηκαν Γενικές Διευθύνσεις ή ο κωδικός του φορέα δεν υπάρχει",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },

    "/apografi/organization/{code}/{gen_dir_code}/directorates": {
      "get": {
        "summary": "Επιστρέφει τις Διευθύνσεις του φορέα με τον κωδικό code που υπάγονται στη Γενική Διεύθυνση με τον κωδικό gen_dir_code",
        "tags": ["Δεδομένα Απογραφής - Μονάδες"],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός του φορέα",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "gen_dir_code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός της Γενικής Διεύθυνσης",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Οι Διευθύνσεις της Γενικής Διευθύνσης του φορέα βρέθηκαν",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "units": {
                      "type": "array",
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Δεν υπάρχουν αποτελέσματα ή ο κωδικός του φορέα ή της Γενικής Διεύθυνσης δεν υπάρχει",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },

    "/apografi/organization/{code}/{dir_code}/departments": {
      "get": {
        "summary": "Επιστρέφει τα τμήματα του φορέα με τον κωδικό code που υπάγονται στη Διεύθυνση με τον κωδικό dir_code",
        "tags": ["Δεδομένα Απογραφής - Μονάδες"],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός του φορέα",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "dir_code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός της Διεύθυνσης",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Τα τμήματα της Διευθύνσης του φορέα βρέθηκαν",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "units": {
                      "type": "array",
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Δεν υπάρχουν αποτελέσματα ή ο κωδικός του φορέα ή της Διεύθυνσης δεν υπάρχει",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },

    "/psped/foreas/{code}": {
      "get": {
        "summary": "Επιστρέφει από το ΠΣΠΕΔ το φορέα με κωδικό {code}",
        "tags": ["ΠΣΠΕΔ - Φορείς"],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "Ο κωδικός του φορέα",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Ο Φορέας βρέθηκε",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          }
        }
      }
    }
  },

  "components": {
    "schemas": {
      "Organization": {
        "type": "object",
        "properties": {
          "code": { "type": "string" },
          "preferredLabel": { "type": "string" },
          "alternativeLabels": {
            "type": "array",
            "items": { "type": "string" }
          },
          "purpose": {
            "type": "array",
            "items": { "type": "integer" }
          },
          "spatial": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/Spatial" }
          },
          "identifier": { "type": "string" },
          "subOrganizationOf": { "type": "string" },
          "organizationType": { "type": "integer" },
          "description": { "type": "string" },
          "url": { "type": "string", "format": "uri" },
          "contactPoint": {
            "$ref": "#/components/schemas/ContactPoint"
          },
          "vatId": { "type": "string" },
          "status": { "type": "string" },
          "foundationDate": { "type": "string", "format": "date-time" },
          "terminationDate": { "type": "string", "format": "date-time" },
          "mainDataUpdateDate": { "type": "string", "format": "date-time" },
          "organizationStructureUpdateDate": {
            "type": "string",
            "format": "date-time"
          },
          "foundationFek": {
            "$ref": "#/components/schemas/FoundationFek"
          },
          "mainAddress": {
            "$ref": "#/components/schemas/Address"
          },
          "secondaryAddresses": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/Address" }
          }
        },
        "required": ["code"]
      },
      "Spatial": {
        "type": "object",
        "properties": {
          "countryId": { "type": "integer" },
          "cityId": { "type": "integer" }
        }
      },

      "ContactPoint": {
        "type": "object",
        "properties": {
          "email": { "type": "string", "format": "email" },
          "telephone": { "type": "string" }
        }
      },

      "FoundationFek": {
        "type": "object",
        "properties": {
          "year": { "type": "integer" },
          "number": { "type": "string" },
          "issue": { "type": "string" }
        }
      },

      "Address": {
        "type": "object",
        "properties": {
          "fullAddress": { "type": "string" },
          "postCode": { "type": "string" },
          "adminUnitLevel1": { "type": "integer" },
          "adminUnitLevel2": { "type": "integer" }
        }
      }
    }
  }
}
